<!DOCTYPE html>
<html lang="en"
      th:replace="~{fragments/admin-layout :: admin-layout(~{::title}, ~{::.content})}"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Manage Categories</title>
</head>
<body>
<div class="content">
    <div class="alert alert-success alert-dismissible fade show"
         role="alert" th:if="${successMessage}">
        <span th:text="${successMessage}"></span>
        <button aria-label="Close" class="btn-close" data-bs-dismiss="alert"
                type="button"></button>
    </div>
    <div class="alert alert-danger alert-dismissible fade show"
         role="alert" th:if="${errorMessage}">
        <span th:text="${errorMessage}"></span>
        <button aria-label="Close" class="btn-close" data-bs-dismiss="alert"
                type="button"></button>
    </div>

    <div class="d-flex flex-column flex-md-row justify-content-between align-items-stretch align-items-md-center mb-4 gap-3">
        <form class="flex-grow-1" method="get"
              th:action="@{/admin/categories/list}">
            <div class="input-group">
                <select class="form-select" name="status"
                        style="max-width: 120px;">
                    <option th:selected="${status == 'all'}" value="all">All
                    </option>
                    <option th:selected="${status == 'active'}" value="active">
                        Active
                    </option>
                    <option th:selected="${status == 'deleted'}"
                            value="deleted">Del
                    </option>
                </select>
                <input class="form-control" name="keyword"
                       placeholder="Search..."
                       th:value="${keyword}" type="text">
                <button class="btn btn-outline-secondary"
                        onclick="this.form.submit()"
                        type="button"><i
                        class="bi bi-search"></i>
                </button>
            </div>
        </form>

        <div class="d-grid d-md-block">
            <a class="btn btn-primary" th:href="@{/admin/categories/add}">
                <i class="bi bi-plus-circle"></i> Add Category
            </a>
        </div>
    </div>

    <div class="card shadow-sm mb-5">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle mb-0">
                    <thead class="table-light text-nowrap">
                    <tr>
                        <th class="w-100">Name</th>
                        <th class="text-center">Status</th>
                        <th class="text-end">Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="category : ${categories}">
                        <td class="fw-semibold text-nowrap"
                            th:text="${category.name}"></td>

                        <td class="text-center">
                            <span class="badge bg-success"
                                  th:if="${!category.isDeleted}">Active</span>
                            <span class="badge bg-secondary"
                                  th:if="${category.isDeleted}">Deleted</span>
                        </td>

                        <td class="text-end">
                            <div class="d-inline-flex gap-1">
                                <a class="btn btn-info btn-sm text-white"
                                   th:classappend="${category.isDeleted} ? 'disabled' : ''"
                                   th:disabled="${category.isDeleted}"
                                   th:href="@{/admin/categories/edit/{id}(id=${category.id})}"
                                   title="Edit">
                                    <i class="bi bi-pencil-fill"></i>
                                </a>

                                <div th:switch="${category.isDeleted}">
                                    <form th:action="@{/admin/categories/delete/{id}(id=${category.id})}"
                                          th:case="false"
                                          th:method="delete">
                                        <button class="btn btn-danger btn-sm"
                                                onclick="return confirm('Are you sure you want to delete this category?')"
                                                title="Delete"
                                                type="submit">
                                            <i class="bi bi-trash-fill"></i>
                                        </button>
                                    </form>
                                    <form th:action="@{/admin/categories/restore/{id}(id=${category.id})}"
                                          th:case="true"
                                          th:method="post">
                                        <button class="btn btn-warning btn-sm text-white"
                                                onclick="return confirm('Are you sure you want to restore this category?')"
                                                title="Restore"
                                                type="submit">
                                            <i class="bi bi-arrow-counterclockwise"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</body>
</html>
